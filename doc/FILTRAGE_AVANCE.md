# üîç **Syst√®me de Filtrage Avanc√© et S√©lection de Rayon Dynamique**

**Version :** 7.0.0  
**Derni√®re mise √† jour :** D√©cembre 2024

## üéØ **Vue d'Ensemble**

Le syst√®me de filtrage avanc√© d'EcoTri permet aux utilisateurs de trouver rapidement les points de recyclage sp√©cifiques √† leurs besoins, tandis que la s√©lection de rayon dynamique offre un contr√¥le pr√©cis sur la zone de recherche g√©ographique.

## üîç **Syst√®me de Filtrage Avanc√©**

### **Types de Filtres Disponibles**

#### **üç∑ Filtre Verre**
- **Mots-cl√©s** : `verre`, `bouteille`, `bouteilles`, `glass`, `bouteilles en verre`, `contenants en verre`
- **Ic√¥ne** : `wine-bar` (MaterialIcons)
- **Couleur** : `colors.success` (vert)
- **Description** : Points de recyclage pour tous types de verre

#### **ü•§ Filtre Plastique**
- **Mots-cl√©s** : `plastique`, `plastic`, `bouteilles en plastique`, `emballages plastique`
- **Ic√¥ne** : `local-drink` (MaterialIcons)
- **Couleur** : `colors.primary` (bleu principal)
- **Description** : Recyclage des mati√®res plastiques

#### **üìÑ Filtre Papier**
- **Mots-cl√©s** : `papier`, `paper`, `carton`, `cardboard`, `livres`, `magazines`, `journaux`
- **Ic√¥ne** : `description` (MaterialIcons)
- **Couleur** : `colors.warning` (orange)
- **Description** : Papier, carton et publications

#### **üî© Filtre M√©tal**
- **Mots-cl√©s** : `m√©tal`, `metal`, `aluminium`, `acier`, `steel`, `bo√Ætes`, `canettes`
- **Ic√¥ne** : `hardware` (MaterialIcons)
- **Couleur** : `colors.text` (gris fonc√©)
- **Description** : M√©taux ferreux et non-ferreux

#### **üì± Filtre √âlectronique**
- **Mots-cl√©s** : `√©lectronique`, `electronics`, `√©lectrique`, `appareils`, `t√©l√©phone`, `ordinateur`
- **Ic√¥ne** : `devices` (MaterialIcons)
- **Couleur** : `colors.error` (rouge)
- **Description** : Appareils √©lectroniques et √©lectriques

#### **üëï Filtre Textile**
- **Mots-cl√©s** : `textile`, `v√™tements`, `clothes`, `chaussures`, `shoes`
- **Ic√¥ne** : `checkroom` (MaterialIcons)
- **Couleur** : `colors.primary` (bleu)
- **Description** : V√™tements et chaussures

#### **üîã Filtre Piles**
- **Mots-cl√©s** : `piles`, `batteries`, `batterie`, `ampoules`, `light_bulbs`
- **Ic√¥ne** : `battery-charging-full` (MaterialIcons)
- **Couleur** : `colors.warning` (orange)
- **Description** : Piles, batteries et ampoules

#### **üå± Filtre Organique**
- **Mots-cl√©s** : `organique`, `organic`, `compost`, `d√©chets verts`, `garden_waste`, `biodegradable`
- **Ic√¥ne** : `eco` (MaterialIcons)
- **Couleur** : `colors.success` (vert)
- **Description** : D√©chets organiques et biod√©gradables

### **Logique de Filtrage Intelligente**

#### **Algorithme de Recherche**
```typescript
const applyFilters = useCallback(() => {
  if (activeFilters.length === 0) {
    setFilteredPoints(recyclingPoints);
    return;
  }

  const filtered = recyclingPoints.filter(point => {
    const pointType = point.type.toLowerCase();
    const pointName = point.display_name.toLowerCase();
    
    return activeFilters.some(filter => {
      // 1. Recherche directe dans le type
      if (pointType.includes(filter)) return true;
      
      // 2. Recherche directe dans le nom
      if (pointName.includes(filter)) return true;
      
      // 3. Recherche avec mots-cl√©s √©tendus
      const filterKeywords = getFilterKeywords(filter);
      return filterKeywords.some(keyword => 
        pointType.includes(keyword) || pointName.includes(keyword)
      );
    });
  });

  setFilteredPoints(filtered);
}, [activeFilters, recyclingPoints]);
```

#### **Syst√®me de Mots-cl√©s Multiples**
```typescript
const getFilterKeywords = (filterKey: string): string[] => {
  const keywords: { [key: string]: string[] } = {
    'glass': ['verre', 'bouteille', 'bouteilles', 'glass', 'bouteilles en verre', 'contenants en verre'],
    'plastic': ['plastique', 'plastic', 'bouteilles en plastique', 'emballages plastique'],
    'paper': ['papier', 'paper', 'carton', 'cardboard', 'livres', 'magazines', 'journaux'],
    'metal': ['m√©tal', 'metal', 'aluminium', 'acier', 'steel', 'bo√Ætes', 'canettes'],
    'electronics': ['√©lectronique', 'electronics', '√©lectrique', 'appareils', 't√©l√©phone', 'ordinateur'],
    'textile': ['textile', 'v√™tements', 'clothes', 'chaussures', 'shoes'],
    'batteries': ['piles', 'batteries', 'batterie', 'ampoules', 'light_bulbs'],
    'organic': ['organique', 'organic', 'compost', 'd√©chets verts', 'garden_waste', 'biodegradable']
  };
  
  return keywords[filterKey] || [filterKey];
};
```

### **Interface de Filtrage**

#### **Composants Visuels**
- **Boutons de filtre** : Design Material avec √©tats actifs/inactifs
- **Scroll horizontal** : Navigation fluide entre tous les filtres
- **Bouton "Effacer"** : Apparition conditionnelle quand des filtres sont actifs
- **Ic√¥nes distinctes** : Chaque type de recyclage a sa propre ic√¥ne

#### **√âtats des Filtres**
```typescript
// √âtat inactif
filterButton: {
  backgroundColor: colors.surface,
  borderColor: colors.border,
}

// √âtat actif
filterButtonActive: {
  backgroundColor: colors.primary,
  borderColor: colors.primary,
}
```

#### **Gestion des Filtres Actifs**
```typescript
const toggleFilter = (filterKey: string) => {
  setActiveFilters(prev => {
    if (prev.includes(filterKey)) {
      return prev.filter(f => f !== filterKey);
    } else {
      return [...prev, filterKey];
    }
  });
};

const clearAllFilters = () => {
  setActiveFilters([]);
};
```

## üìè **S√©lection de Rayon Dynamique**

### **Rayons Disponibles**

| Rayon | Label | Description |
|-------|-------|-------------|
| 500m | `500m` | Zone tr√®s proche, points de quartier |
| 1000m | `1km` | Zone proche, points accessibles √† pied |
| 2000m | `2km` | Zone interm√©diaire, points accessibles en v√©lo |
| 5000m | `5km` | Zone large, points accessibles en voiture |
| 10000m | `10km` | Zone tr√®s large, points √©loign√©s |

### **Interface de S√©lection**

#### **Composant Dropdown**
```typescript
<View style={styles.radiusSelector}>
  <TouchableOpacity
    style={styles.radiusDropdown}
    onPress={() => setShowRadiusMenu(!showRadiusMenu)}
  >
    <Text style={styles.radiusValue}>
      {radiusOptions.find(opt => opt.value === searchRadius)?.label}
    </Text>
    <MaterialIcons name="keyboard-arrow-down" size={16} color={colors.primary} />
  </TouchableOpacity>
</View>
```

#### **Menu Modal**
```typescript
<Modal
  visible={showRadiusMenu}
  transparent={true}
  animationType="fade"
  onRequestClose={() => setShowRadiusMenu(false)}
>
  <TouchableOpacity
    style={styles.modalOverlay}
    activeOpacity={1}
    onPress={() => setShowRadiusMenu(false)}
  >
    <View style={styles.radiusMenuModal}>
      {radiusOptions.map((option) => (
        <TouchableOpacity
          key={option.value}
          style={styles.radiusMenuItem}
          onPress={() => {
            setSearchRadius(option.value);
            setShowRadiusMenu(false);
          }}
        >
          <Text style={[
            styles.radiusMenuItemText,
            searchRadius === option.value && styles.radiusMenuItemTextActive
          ]}>
            {option.label}
          </Text>
        </TouchableOpacity>
      ))}
    </View>
  </TouchableOpacity>
</Modal>
```

### **Mise √† Jour Automatique**

#### **Effet de Changement de Rayon**
```typescript
useEffect(() => {
  if (userLocation) {
    fetchRecyclingPoints(userLocation.lat, userLocation.lon);
  }
}, [searchRadius, userLocation, fetchRecyclingPoints]);
```

#### **Int√©gration avec Overpass API**
```typescript
const overpassQuery = `
  [out:json][timeout:25];
  (
    node["amenity"="recycling"](around:${searchRadius},${latitude},${longitude});
    way["amenity"="recycling"](around:${searchRadius},${latitude},${longitude});
    relation["amenity"="recycling"](around:${searchRadius},${latitude},${longitude});
    // ... autres types avec around:${searchRadius}
  );
  out body;
  >;
  out skel qt;
`;
```

## üé® **Interface Utilisateur Modernis√©e**

### **Layout Compact**

#### **Section de Localisation**
- **Position √† gauche** : Ville avec emoji üìç
- **Rayon √† droite** : S√©lecteur compact
- **Bouton de rafra√Æchissement** : Centr√© et unique

#### **Section de Filtres**
- **Scroll horizontal** : Navigation fluide
- **Boutons visuels** : Ic√¥nes et couleurs distinctes
- **Bouton "Effacer"** : Apparition conditionnelle

### **Design Responsive**

#### **Adaptation Mobile**
- **Filtres scrollables** : Fonctionne sur tous les √©crans
- **Menu de rayon** : Modal overlay toujours visible
- **Boutons tactiles** : Taille optimis√©e pour le touch

#### **Gestion des √âtats**
- **Filtres actifs** : Visuellement distincts
- **Rayon s√©lectionn√©** : Mise en √©vidence claire
- **Chargement** : Indicateurs visuels appropri√©s

## üîß **Impl√©mentation Technique**

### **Structure des Donn√©es**

#### **√âtat des Filtres**
```typescript
const [activeFilters, setActiveFilters] = useState<string[]>([]);
const [filteredPoints, setFilteredPoints] = useState<RecyclingPoint[]>([]);
```

#### **√âtat du Rayon**
```typescript
const [searchRadius, setSearchRadius] = useState<number>(1000);
const [showRadiusMenu, setShowRadiusMenu] = useState<boolean>(false);
```

### **Performance et Optimisation**

#### **Filtrage Client-Side**
- **R√©activit√© maximale** : Pas de d√©lai r√©seau
- **Mise √† jour instantan√©e** : Filtrage en temps r√©el
- **Gestion m√©moire** : Points filtr√©s stock√©s localement

#### **D√©bogage et Logs**
```typescript
console.log('üîç Appliquer les filtres:', activeFilters);
console.log('üìç Points disponibles:', recyclingPoints.length);
console.log(`üîç Point: ${point.display_name}`);
console.log(`   Type: ${point.type}`);
console.log(`üéØ R√©sultat: ${filtered.length} points filtr√©s sur ${recyclingPoints.length} total`);
```

## üöÄ **Avantages Utilisateur**

### **Exp√©rience de Filtrage**
- **Recherche pr√©cise** : Trouve facilement les points sp√©cifiques
- **Interface intuitive** : Boutons visuels avec ic√¥nes distinctes
- **Filtrage rapide** : R√©sultats en temps r√©el
- **Gestion des filtres** : Ajout/suppression facile

### **Contr√¥le du Rayon**
- **Flexibilit√©** : Choix du rayon selon les besoins
- **Interface compacte** : S√©lecteur qui ne prend pas de place
- **Mise √† jour imm√©diate** : R√©sultats instantan√©s
- **Rayons adapt√©s** : Du tr√®s proche au tr√®s large

### **Interface Optimis√©e**
- **Plus d'espace** : Layout compact pour le contenu principal
- **Navigation fluide** : Filtres et rayon facilement accessibles
- **Design coh√©rent** : Style uniforme avec le reste de l'application
- **Responsive** : Fonctionne sur tous les appareils

## üîÆ **√âvolutions Futures**

### **Version 7.1.0 (Pr√©vue)**
- **üó∫Ô∏è Carte interactive** : Affichage des points filtr√©s sur une carte
- **üíæ Sauvegarde des pr√©f√©rences** : M√©morisation des filtres et rayon favoris
- **üîî Notifications** : Rappels de recyclage personnalis√©s
- **üìä Statistiques de filtrage** : Historique des recherches populaires

### **Version 7.2.0 (Pr√©vue)**
- **ü§ñ IA de recommandation** : Suggestions de points selon l'historique
- **üåç Mode hors ligne** : Synchronisation des donn√©es de recyclage
- **üì± Widgets** : Acc√®s rapide aux filtres depuis l'√©cran d'accueil
- **üåô Mode sombre** : Th√®me adaptatif pour l'interface

---

## üìö **R√©f√©rences Techniques**

- **React Native** : [Documentation officielle](https://reactnative.dev/)
- **Material Icons** : [Biblioth√®que d'ic√¥nes](https://material.io/icons/)
- **Overpass API** : [Documentation API](https://wiki.openstreetmap.org/wiki/Overpass_API)
- **Nominatim API** : [Documentation API](https://nominatim.org/release-docs/latest/api/Overview/)

---

**Documentation g√©n√©r√©e le :** D√©cembre 2024  
**Version EcoTri :** 7.0.0  
**Auteur :** Assistant IA - EcoTri Development Team
